Алгоритм закраски

1. Находим первую незакрашенную точку, идя слева направо, сверху вниз.
2. Проверяем всех закрашенных соседей. Если среди них находим смежного, красим точку в тот же цвет. 
Если все закрашенные соседи изолированы, красим точку в новый цвет и создаем парные цветные точки контуров в местах изоляции.

Собираем контуры из одноцветных закрашенных контурных точек.